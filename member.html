<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Member Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
</head>
<body>
  <h1>Member Dashboard</h1>
  <p id="welcome"></p>

  <h2>Your Progress History</h2>
  <ul id="progressList"></ul>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAMnu2djtDKXMrTVKnppeCfKXRCy1KkEYk",
      authDomain: "lita-platform-bffdc.firebaseapp.com",
      projectId: "lita-platform-bffdc",
      storageBucket: "lita-platform-bffdc.appspot.com",
      messagingSenderId: "387943226211",
      appId: "1:387943226211:web:0127c409e0f880df391156",
      measurementId: "G-44JEYP8ZHD"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.getAuth(app);
    const db = firebase.getFirestore(app);

    firebase.onAuthStateChanged(auth, async (user) => {
      if (user) {
        const docSnap = await firebase.getDoc(firebase.doc(db, "members", user.uid));
        if (docSnap.exists()) {
          const data = docSnap.data();
          document.getElementById("welcome").innerText = `Welcome, ${data.name} (ID: ${data.memberId})`;

          const progressList = document.getElementById("progressList");
          progressList.innerHTML = "";
          (data.progress || []).forEach((p) => {
            const li = document.createElement("li");
            li.textContent = p;
            progressList.appendChild(li);
          });
        }
      } else {
        window.location.href = "login.html";
      }
    });
  </script>
</body>
</html>
